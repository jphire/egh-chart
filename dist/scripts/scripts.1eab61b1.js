"use strict";var greenhouseApp=angular.module("greenhouseApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","firebase"]).config(["$routeProvider",function(a){a.when("/main",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/channels/:id",{templateUrl:"views/channel.html",controller:"ChannelCtrl"}).otherwise({redirectTo:"/main"})}]);greenhouseApp.filter("reverse",function(){function a(a){var b,c=[];if(a)if(angular.isArray(a))c=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}return function(b){return a(b).slice().reverse()}}),angular.module("greenhouseApp").controller("MainCtrl",["$scope","$routeParams","$http","$location","$firebase",function(a,b,c,d,e){var f=new Firebase("https://greenhouse.firebaseio.com/channels");a.channels=e(f),a.appUrl=d.$$host+":"+d.$$port,a.addChannel=function(){var b=a.fields,c=f.push(b),d=c.path.n[1],e=[{id:d,data:[]}],g=c.child("data");g.set(e)}}]),angular.module("greenhouseApp").controller("ChannelCtrl",["$scope","$routeParams","$http","$firebase",function(a,b,c,d){a.id=b.id;var e=new Firebase("https://greenhouse.firebaseio.com/channels/"+a.id);a.channel=d(e);var f=new Firebase("https://greenhouse.firebaseio.com/channels/"+a.id+"/data/0/data");a.data=d(f.limit(20)),Highcharts.setOptions({global:{useUTC:!1}}),f.once("value",function(b){var c=[],d=b.val();for(var e in d)d.hasOwnProperty(e)&&c.push(d[e]);$("#chart1").highcharts("StockChart",{series:[{id:a.id,data:c}]})}),f.endAt().limit(1).on("child_added",function(b){var c=b.val()[0],d=parseFloat(b.val()[1]);$("#chart1").highcharts().get(a.id).addPoint([c,d])}),a.parseDate=function(a){var b=new Date(a);return b.getDate()+"."+(b.getMonth()+1)+"."+b.getFullYear()+" "+b.getHours()+":"+b.getMinutes()+":"+b.getSeconds()},a.addData=function(){a.fields&&a.fields.value&&f.push([Date.parse(new Date),parseFloat(a.fields.value)],function(a){console.log("done",a),$("#data-value")[0].value=""})},a.removeData=function(){var b=confirm("Are you sure to remove all data?");b&&($("#chart1").highcharts().get(a.id).setData([]),f.remove(function(){console.log("done")}))}}]);