"use strict";var greenhouseApp=angular.module("greenhouseApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","firebase"]).config(["$routeProvider",function(a){a.when("/chart",{templateUrl:"views/chart.html",controller:"ChartCtrl"}).when("/channels",{templateUrl:"views/channels.html",controller:"ChannelsCtrl"}).when("/channels/:id",{templateUrl:"views/channel.html",controller:"ChannelCtrl"}).otherwise({redirectTo:"/chart"})}]);angular.module("greenhouseApp").factory("channel",["$firebase",function(a){return{getChannel:function(b){var c=new Firebase("https://greenhouse.firebaseio.com/channels/"+b);return a(c)},getChannelData:function(a){var b=new Firebase("https://greenhouse.firebaseio.com/channels/"+a+"/data"),c=[];return b.on("value",function(a){c=a.val()}),c}}}]),angular.module("greenhouseApp").factory("channels",["$firebase",function(a){var b=new Firebase("https://greenhouse.firebaseio.com/channels");return a(b)}]),angular.module("greenhouseApp").controller("ChartCtrl",["$scope","$routeParams","$http",function(a){{var b=new Firebase("https://greenhouse.firebaseio.com/channels/");Date.parse(new Date)}console.log(b),b.on("value",function(b){console.log(b.val()),a.data=b.val()}),$("#chart1").highcharts("StockChart",{series:[]})}]),angular.module("greenhouseApp").controller("ChannelsCtrl",["$scope","$routeParams","$http","$location","channels",function(a,b,c,d,e){var f=Date.parse(new Date);a.channels=e,a.appUrl=d.$$host+":"+d.$$port,a.addChannel=function(){var b=a.fields,d="https://greenhouse.firebaseio.com/channels.json";console.log(b),c({url:d,method:"POST",data:JSON.stringify(b),headers:{"Content-Type":"application/json"}}).success(function(a){var b=[{id:a.name,data:[[f,34]]}],d="https://greenhouse.firebaseio.com/channels/"+a.name+"/data.json";console.log("Success",b),c({url:d,method:"PUT",data:JSON.stringify(b),headers:{"Content-Type":"application/json"}}).success(function(a){console.log("Success",a)})})}}]),angular.module("greenhouseApp").controller("ChannelCtrl",["$scope","$routeParams","$http","$firebase",function(a,b,c,d){a.id=b.id;var e=new Firebase("https://greenhouse.firebaseio.com/channels/"+a.id+"/data/0/data");a.data=d(e),$("#chart1").highcharts("StockChart",{series:[{id:a.id,data:[]}]}),e.on("child_added",function(b){var c=b.val()[0],d=parseFloat(b.val()[1]);$("#chart1").highcharts().get(a.id).addPoint([c,d])}),a.parseDate=function(a){var b=new Date(a);return b.getDate()+"."+b.getMonth()+"."+b.getFullYear()+" "+b.getHours()+":"+b.getMinutes()+":"+b.getSeconds()},a.addData=function(){a.fields&&a.fields.value&&e.push([Date.parse(new Date),parseFloat(a.fields.value)],function(a){console.log("done",a),$("#data-value")[0].value=""})},a.removeData=function(){$("#chart1").highcharts().get(a.id).setData([]),e.remove(function(){console.log("done")})}}]);